{"componentChunkName":"component---src-templates-blog-post-js","path":"/publish-github-pages-with-github-actions/","result":{"data":{"site":{"siteMetadata":{"title":"itsopensource"}},"markdownRemark":{"id":"4a7b05fd-30a2-5846-9e82-84d396f6c7b4","excerpt":"GitHub pages are the best way to host static blogs like . One of the most common ways to do this is, maintain your code in main/master branch, build it, and…","html":"<p>GitHub pages are the best way to host static blogs like <code class=\"language-text\">Gatsby</code>. One of the most common ways to do this is, maintain your code in main/master branch, build it, and then push the code to <code class=\"language-text\">gh-pages</code> branch.\nThere are various CI that easily automate this process like Travis CI, CircleCI, etc.\nWith GitHub actions, this would be a piece of cake, and without depending on any third-party provider. From the docs:</p>\n<blockquote>\n<p>Automate, customize, and execute your software development workflows right in your repository with GitHub Actions</p>\n</blockquote>\n<p>If you are not sure what are GitHub actions please visit <a href=\"https://github.com/features/actions\">here</a>.</p>\n<h2><center> Workflow </center></h2>\n<h4>Prerequisites</h4>\n<ol>\n<li>You have a static blog(let’s say gatsby) setup, the code for your blog is in master branch.</li>\n<li>You have a build script in your package.json</li>\n<li>You have setup your GitHub pages (or pointed to your custom domain) in <code class=\"language-text\">gh-pages</code> branch.</li>\n</ol>\n<h4>Process</h4>\n<p><strong><center> Step 1 </center></strong><br>\nInstall <a href=\"https://www.npmjs.com/package/gh-pages\">gh-pages npm package</a> in your project, this is a small utility package which helps to publish your code to gh-pages branch.\nYou can skip this step in case you want to push all contents from master to <code class=\"language-text\">gh-pages</code> branch.</p>\n<p><strong><center>Step 2 </center></strong><br>\nAdd a deploy script in your <code class=\"language-text\">package.json</code>. This script should do 2 jobs</p>\n<ol>\n<li>Build the project, make it ready for being published.</li>\n<li>Push the changes to the <code class=\"language-text\">gh-pages</code> branch.</li>\n</ol>\n<p>For example, this pushes the code to <code class=\"language-text\">gh-pages</code> via npm package.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\"deploy\": \"gatsby build &amp;&amp; gh-pages -d public -r https://$GH_TOKEN@github.com/&lt;username>/&lt;repository_name>.git\"</code></pre></div>\n<p><strong><center>Step 3 </center></strong><br>\nGenerate an access token and add it to secret of your repository.</p>\n<ol>\n<li>Create an access token: goto <a href=\"https://github.com/settings/tokens\">https://github.com/settings/tokens</a>, create a new token, give it access for repo and workflow.</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/30aebc71ae3bcb4ee8e555ba47aa0951/7527b/action1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.86486486486486%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABgUlEQVR42pVTCXKEIBD0/z9MapNKvC8QBVG8OjPsumsOU4lVLTND0fQcBFmeIwwjhFGEOE5ojT3eKcZ7//0C21u0bYuu69ASOq3J76A12RQfrMU4Dtd1GK5gn9a+72Epbu0AYyymaUJQC4GIFMVJ6hFFifffcoXntMVLxlC4pA0uZL/mLZ7ixu/rm4BdhHNEKIiQb+NvXdcHNnzDcrC3s5SZOWRVVL8ky+FI9jzPnzDdMM8Ltu1BtVsc2+NBoxSKskRVCyzL8u3GMyWnCqu6RpKmyPPiXgtetTa+UcouUFQRNWwQ/Qph2F/Pu+ycQ02kXMcdPXVOSOlVV7JDIQ1yQVNgHHq3epwScu6shJtjD82RjfKoiZT3p8n9WJKvZQjY4HmKkwQZNWUcR09YC4myqr3KshJ+xvZD22+DzT9jeqpjRnXTPshKOOWdsCgrX9M/vRSeKUMKSzokZePJjinvaAjHkTklbO2GUjT++e0zxYRtRy+gu3ZbUwbsz8tyn7kzfABAU/O2YAzVfQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"access token\"\n        title=\"\"\n        src=\"/static/30aebc71ae3bcb4ee8e555ba47aa0951/fcda8/action1.png\"\n        srcset=\"/static/30aebc71ae3bcb4ee8e555ba47aa0951/12f09/action1.png 148w,\n/static/30aebc71ae3bcb4ee8e555ba47aa0951/e4a3f/action1.png 295w,\n/static/30aebc71ae3bcb4ee8e555ba47aa0951/fcda8/action1.png 590w,\n/static/30aebc71ae3bcb4ee8e555ba47aa0951/7527b/action1.png 754w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n2. Add this token to secret of your repository: goto <code class=\"language-text\">https://github.com/&lt;username>/&lt;repository_name>/settings/secrets/actions</code>, click <code class=\"language-text\">new repository secret</code>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9109d16686926974e4becbfa4d63c8cd/bf433/action2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.972972972972975%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAnUlEQVR42q3STQ7CIBAFYK7vKbyEF/AEXkE32h+FErUMheFJZ0Fid4SSvA0JXx6ZUTcT0Y8aj65DPwxgZrQcZd4OSwgg8iBP4JSQNqkCtdaYrIWZLPyySMMY41+qQEckLUJ+KO3y5TZV4Ph84TvPGWNBWyIgeS9fbcUKGJl3wQqIvCUcUzO2bso6C3X/DDDOynRbUhoeLkecrmfsdX5LZxUL0B5eQAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"secret token\"\n        title=\"\"\n        src=\"/static/9109d16686926974e4becbfa4d63c8cd/fcda8/action2.png\"\n        srcset=\"/static/9109d16686926974e4becbfa4d63c8cd/12f09/action2.png 148w,\n/static/9109d16686926974e4becbfa4d63c8cd/e4a3f/action2.png 295w,\n/static/9109d16686926974e4becbfa4d63c8cd/fcda8/action2.png 590w,\n/static/9109d16686926974e4becbfa4d63c8cd/efc66/action2.png 885w,\n/static/9109d16686926974e4becbfa4d63c8cd/bf433/action2.png 971w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><strong><center>Step 4 </center></strong></p>\n<ol>\n<li>Create a workflow file, you need to create a file in following path: <code class=\"language-text\">.github/workflows/&lt;some-name-you-like>.yml</code>, its important to have <code class=\"language-text\">.yml</code> extension and have exact same path.</li>\n<li>Following action file is complete enough to publish <code class=\"language-text\">gh-pages</code>, every time a new commit is merged in master branch. ✅</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\">   <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> gh<span class=\"token punctuation\">-</span>pages publisher 🚀\n\n   <span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n   <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span> master <span class=\"token punctuation\">]</span>\n\n   <span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n   <span class=\"token key atrule\">publish-gh-pages</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n      <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n         <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v2\n         <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>node@v1\n         <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">node-version</span><span class=\"token punctuation\">:</span> <span class=\"token number\">12</span>\n         <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm ci\n         <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> git config user.name \"&lt;user name<span class=\"token punctuation\">></span>\" <span class=\"token important\">&amp;&amp;</span> git config user.email \"user email\"\n         <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm run deploy\n         <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">GH_TOKEN</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>secrets.SECRET_GITHUB_TOKEN<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>This script is pretty self-explanatory, it performs the following tasks.</p>\n<ul>\n<li>It specifies to work only on <code class=\"language-text\">push</code> on <code class=\"language-text\">master</code></li>\n<li>Sets up a <code class=\"language-text\">node 12</code> environment</li>\n<li>Installs dependencies via <code class=\"language-text\">npm ci</code></li>\n<li>Sets up git requirements for username and email (required to do a push to branch)</li>\n<li>Run the deploy script</li>\n<li>In case you don’t use gh-pages npm package, you can write another step for git push to gh-pages branch.</li>\n<li>At last, we set up env variable <code class=\"language-text\">GH_TOKEN</code> from our action secret (which you set up in step 3), this env variable would be available in <code class=\"language-text\">package.json</code></li>\n</ul>\n<p><strong><center>Step 5 </center></strong><br>\nCommit this file and see your first <code class=\"language-text\">action</code> in action (sorry for the pun 🙈 )</p>\n<hr>\n<center>Hope this helps 🙏🙏🙏</center>\n<hr>\n<br/>\n<ul>\n<li>\n<p>You can see the actions running here: <code class=\"language-text\">https://github.com/&lt;username>/&lt;repository_name>/actions</code>.</p>\n</li>\n<li>\n<p>Workflow file for <a href=\"https://itsopensource.com\">itsopensource.com</a> can be viewed <a href=\"https://github.com/tsl143/itsopensource/blob/master/.github/workflows/gh-pages-publish.yml\">here</a>.</p>\n</li>\n</ul>","frontmatter":{"title":"Publish GitHub pages with GitHub Actions","tags":["automation","ci","github-actions"],"date":"December 12, 2020","description":null,"author":"trishul","featuredImage":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1klEQVR42qWQ20rDQBCG8/4v4F1foOCdFH2AoiL1SkMpgofYbDZpjq27ie1+bhKkLdjSrT8MwzDMNzO/xxEZG98bnOT9CTJ99mO4mkGu+npj/gm8eYGLB3jN+/qUa71Dr7aKVzB4hGsLvv+Ekb02rPaXOgFXDdwGcOnD+AOGT2cCd3UXmA40mcNztPXT4Aj8HVBrmKYg7fuZhnp9hoda1yzSjGSRIoSkLHK+lCJJEqrlsutleUHdNKcB22EhZQd8ew8Io5iirAhbuM1zESEiidLa3UNX/QB2zREkNh56gwAAAABJRU5ErkJggg==","aspectRatio":2.0408163265306123,"src":"/static/42143b9a1f8f163ccc6f87d27cc83674/ee604/github-actions.png","srcSet":"/static/42143b9a1f8f163ccc6f87d27cc83674/69585/github-actions.png 200w,\n/static/42143b9a1f8f163ccc6f87d27cc83674/497c6/github-actions.png 400w,\n/static/42143b9a1f8f163ccc6f87d27cc83674/ee604/github-actions.png 800w,\n/static/42143b9a1f8f163ccc6f87d27cc83674/f3583/github-actions.png 1200w,\n/static/42143b9a1f8f163ccc6f87d27cc83674/b350d/github-actions.png 1390w","sizes":"(max-width: 800px) 100vw, 800px"}}}}}},"pageContext":{"slug":"/publish-github-pages-with-github-actions/","previous":{"fields":{"slug":"/creating-accordions-with-native-html/"},"frontmatter":{"author":"shivam","tags":["html","mindblowing","how-to"],"title":"Creating accordions with native HTML"}},"next":{"fields":{"slug":"/readabilityjs-adding-reader-view/"},"frontmatter":{"author":"trishul","tags":["accessibility","javascript","firefox"],"title":"ReadabilityJS - adding Reader View Mode to websites"}}}},"staticQueryHashes":["4268877247","764694655"],"slicesMap":{}}